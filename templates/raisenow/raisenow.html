{% extends "public.html" %}
{% block page %}
<div :style="'background-image:url('+background_image+'); background-size: cover; min-height: 100vh; padding: 20px;'" class="q-pa-md">
  <div style="background-color: white; display: flex; align-items: center;">
    <img :src="header_image" alt="Header Image" style="max-width: 100px; height: auto; margin-right: 20px;">
    <h1>Your Header Text Here</h1>
  </div>
  <div class="row q-col-gutter-md justify-center q-mt-md">{% raw %}
    <div v-for="participant in participants" :key="participant.id" class="col-12 col-sm-6 col-md-4 col-lg-3 q-gutter-y-md">
      <q-card style="width: 80%; margin: 0 auto;">
        <q-card-section>
          <div class="text-center">
            <img :src="participant.image" alt="Participant Image" class="q-mx-auto q-my-md" style="display: block; max-width: 100%; height: auto;">
            <h6 class="text-subtitle1 q-mb-sm q-mt-none">{{ participant.name }}</h6>
            <p class="q-my-none">{{ participant.description }}</p>
          </div>
        </q-card-section>
        <q-card-section class="q-pa-none">
          <div class="text-center q-mt-md">
            <q-responsive :ratio="1" class="q-mx-md">
              <qrcode :value="participant.lnurlpay" :options="{width: 200}" class="rounded-borders"></qrcode>
            </q-responsive>
          </div>
          <div class="text-center q-mt-md">
            <q-btn outline color="grey" @click="copyText(participant.lnurlpay)">Copy LNURL</q-btn>
          </div>
          <div class="text-center q-mt-md">
            <h6>Total: {{ participant.total }}</h6>
          </div>{% endraw %}
        </q-card-section>
      </q-card>
    </div>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script>
  Vue.component(VueQrcode.name, VueQrcode)

  new Vue({
  el: '#vue',
  mixins: [windowMixin],
  data: function () {
    return {
      raise_lnurlpay: '{{ lnurlpay }}',
      raisenow_id: '{{ raisenow_id }}',
      header_image: '{{ header_image }}',
      background_image: '{{ background_image }}',
      participants: '{{ participants }}'
    }
  },
  created: function () {
   this.participants = JSON.parse(this.participants)
    // Will trigger payment reaction when payment received, sent from tasks.py
    eventReactionWebocket(this.raisenow_id)
    console.log(this.participants)
  },
  methods: {
    copyText(text) {
      navigator.clipboard.writeText(text).then(() => {
        this.$q.notify({
          message: 'Copied to clipboard',
          color: 'green',
          timeout: 1000
        })
      })
    }
  }
})
</script>
{% endblock %}